// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"bytes"
	"encoding/json"
	"errors"
)

type RuleType string

const (
	RuleTypeRetryRule  RuleType = "RetryRule"
	RuleTypeAlertRule  RuleType = "AlertRule"
	RuleTypeFilterRule RuleType = "FilterRule"
	RuleTypeAny        RuleType = "any"
	RuleTypeDelayRule  RuleType = "DelayRule"
)

type Rule struct {
	RetryRule  *RetryRule
	AlertRule  *AlertRule
	FilterRule *FilterRule
	Any        interface{}
	DelayRule  *DelayRule

	Type RuleType
}

func CreateRuleRetryRule(retryRule RetryRule) Rule {
	typ := RuleTypeRetryRule

	return Rule{
		RetryRule: &retryRule,
		Type:      typ,
	}
}

func CreateRuleAlertRule(alertRule AlertRule) Rule {
	typ := RuleTypeAlertRule

	return Rule{
		AlertRule: &alertRule,
		Type:      typ,
	}
}

func CreateRuleFilterRule(filterRule FilterRule) Rule {
	typ := RuleTypeFilterRule

	return Rule{
		FilterRule: &filterRule,
		Type:       typ,
	}
}

func CreateRuleAny(any interface{}) Rule {
	typ := RuleTypeAny

	return Rule{
		Any:  &any,
		Type: typ,
	}
}

func CreateRuleDelayRule(delayRule DelayRule) Rule {
	typ := RuleTypeDelayRule

	return Rule{
		DelayRule: &delayRule,
		Type:      typ,
	}
}

func (u *Rule) UnmarshalJSON(data []byte) error {
	var d *json.Decoder

	retryRule := new(RetryRule)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&retryRule); err == nil {
		u.RetryRule = retryRule
		u.Type = RuleTypeRetryRule
		return nil
	}

	alertRule := new(AlertRule)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&alertRule); err == nil {
		u.AlertRule = alertRule
		u.Type = RuleTypeAlertRule
		return nil
	}

	filterRule := new(FilterRule)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&filterRule); err == nil {
		u.FilterRule = filterRule
		u.Type = RuleTypeFilterRule
		return nil
	}

	any := new(interface{})
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&any); err == nil {
		u.Any = any
		u.Type = RuleTypeAny
		return nil
	}

	delayRule := new(DelayRule)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&delayRule); err == nil {
		u.DelayRule = delayRule
		u.Type = RuleTypeDelayRule
		return nil
	}

	return errors.New("could not unmarshal into supported union types")
}

func (u Rule) MarshalJSON() ([]byte, error) {
	if u.RetryRule != nil {
		return json.Marshal(u.RetryRule)
	}

	if u.AlertRule != nil {
		return json.Marshal(u.AlertRule)
	}

	if u.FilterRule != nil {
		return json.Marshal(u.FilterRule)
	}

	if u.Any != nil {
		return json.Marshal(u.Any)
	}

	if u.DelayRule != nil {
		return json.Marshal(u.DelayRule)
	}

	return nil, nil
}
