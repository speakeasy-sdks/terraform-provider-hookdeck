// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"bytes"
	"encoding/json"
	"errors"
)

type RuleType string

const (
	RuleTypeRetryRule     RuleType = "RetryRule"
	RuleTypeAlertRule     RuleType = "AlertRule"
	RuleTypeFilterRule    RuleType = "FilterRule"
	RuleTypeTransformRule RuleType = "TransformRule"
	RuleTypeDelayRule     RuleType = "DelayRule"
)

type Rule struct {
	RetryRule     *RetryRule
	AlertRule     *AlertRule
	FilterRule    *FilterRule
	TransformRule *TransformRule
	DelayRule     *DelayRule

	Type RuleType
}

func CreateRuleRetryRule(retryRule RetryRule) Rule {
	typ := RuleTypeRetryRule

	return Rule{
		RetryRule: &retryRule,
		Type:      typ,
	}
}

func CreateRuleAlertRule(alertRule AlertRule) Rule {
	typ := RuleTypeAlertRule

	return Rule{
		AlertRule: &alertRule,
		Type:      typ,
	}
}

func CreateRuleFilterRule(filterRule FilterRule) Rule {
	typ := RuleTypeFilterRule

	return Rule{
		FilterRule: &filterRule,
		Type:       typ,
	}
}

func CreateRuleTransformRule(transformRule TransformRule) Rule {
	typ := RuleTypeTransformRule

	return Rule{
		TransformRule: &transformRule,
		Type:          typ,
	}
}

func CreateRuleDelayRule(delayRule DelayRule) Rule {
	typ := RuleTypeDelayRule

	return Rule{
		DelayRule: &delayRule,
		Type:      typ,
	}
}

func (u *Rule) UnmarshalJSON(data []byte) error {
	var d *json.Decoder

	retryRule := new(RetryRule)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&retryRule); err == nil {
		u.RetryRule = retryRule
		u.Type = RuleTypeRetryRule
		return nil
	}

	alertRule := new(AlertRule)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&alertRule); err == nil {
		u.AlertRule = alertRule
		u.Type = RuleTypeAlertRule
		return nil
	}

	filterRule := new(FilterRule)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&filterRule); err == nil {
		u.FilterRule = filterRule
		u.Type = RuleTypeFilterRule
		return nil
	}

	transformRule := new(TransformRule)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&transformRule); err == nil {
		u.TransformRule = transformRule
		u.Type = RuleTypeTransformRule
		return nil
	}

	delayRule := new(DelayRule)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&delayRule); err == nil {
		u.DelayRule = delayRule
		u.Type = RuleTypeDelayRule
		return nil
	}

	return errors.New("could not unmarshal into supported union types")
}

func (u Rule) MarshalJSON() ([]byte, error) {
	if u.RetryRule != nil {
		return json.Marshal(u.RetryRule)
	}

	if u.AlertRule != nil {
		return json.Marshal(u.AlertRule)
	}

	if u.FilterRule != nil {
		return json.Marshal(u.FilterRule)
	}

	if u.TransformRule != nil {
		return json.Marshal(u.TransformRule)
	}

	if u.DelayRule != nil {
		return json.Marshal(u.DelayRule)
	}

	return nil, nil
}
